version: 2

sources:
  - name: decidim
    schema: public
    description: Replica of Decidim data.
    tables:
      - name: decidim_accountability_results
      - name: decidim_assemblies
      - name: decidim_attachments
      - name: decidim_blogs_posts
      - name: decidim_budgets_budgets
      - name: decidim_budgets_projects
      - name: decidim_categories
      - name: decidim_categorizations
      - name: decidim_comments_comments
      - name: decidim_components
      - name: decidim_conferences
      - name: decidim_debates_debates
      - name: decidim_endorsements
      - name: decidim_forms_questionnaires
      - name: decidim_follows
      - name: decidim_initiatives
        freshness: null
      - name: decidim_meetings_meetings
      - name: decidim_organizations
      - name: decidim_participatory_processes
      - name: decidim_proposals_proposals
      - name: decidim_users


models:
  - name: blog_posts
    description: All blog posts created on the platform
    columns:
      - name: id
        description: Primary key
  
  - name: organizations
    description: List all organizations of the Decidim instance
    config:
      materialized: view
    columns:
      - name: id
        description: Primary key

  - name: proposals
    description: all proposals of the decidim instance
    columns:
      - name: id
        description: my wonderful banana is splitted
        meta:   
          metabase.semantic_type: type/PK
      - name: first_author_id
        description: ID of the author
        meta:
          metabase.semantic_type: type/FK
          metabase.fk_target_table: models.users
          metabase.fk_target_field: id
  - name: users
    description: all users
    columns:
      - name: id
        description: PK
#     config:
#       tags: ['pii']
#     columns:
#       - name: customer_id
#         tests:
#           - unique
#           - not_null

#   - name: stg_jaffle_shop__orders
#     config:
#       materialized: view
#     columns:
#       - name: order_id
#         tests:
#           - unique
#           - not_null
#       - name: status
#         tests:
#           - accepted_values:
#               values: ['placed', 'shipped', 'completed', 'return_pending', 'returned']
#               config:
#                 severity: warn

